(()=>{function t(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}var e={};Object.defineProperty(e,"__esModule",{value:!0});var n={};t(n,"create",(()=>o)),t(n,"fromMat4",(()=>a)),t(n,"clone",(()=>h)),t(n,"copy",(()=>c)),t(n,"fromValues",(()=>u)),t(n,"set",(()=>l)),t(n,"identity",(()=>p)),t(n,"transpose",(()=>d)),t(n,"invert",(()=>f)),t(n,"adjoint",(()=>v)),t(n,"determinant",(()=>m)),t(n,"multiply",(()=>x)),t(n,"translate",(()=>g)),t(n,"rotate",(()=>M)),t(n,"scale",(()=>w)),t(n,"fromTranslation",(()=>y)),t(n,"fromRotation",(()=>_)),t(n,"fromScaling",(()=>b)),t(n,"fromMat2d",(()=>S)),t(n,"fromQuat",(()=>R)),t(n,"normalFromMat4",(()=>z)),t(n,"projection",(()=>E)),t(n,"str",(()=>V)),t(n,"frob",(()=>P)),t(n,"add",(()=>C)),t(n,"subtract",(()=>T)),t(n,"multiplyScalar",(()=>q)),t(n,"multiplyScalarAndAdd",(()=>X)),t(n,"exactEquals",(()=>I)),t(n,"equals",(()=>L)),t(n,"mul",(()=>F)),t(n,"sub",(()=>D));var i=1e-6,r="undefined"!=typeof Float32Array?Float32Array:Array,s=Math.random;Math.PI;function o(){var t=new r(9);return r!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function h(t){var e=new r(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function c(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function u(t,e,n,i,s,o,a,h,c){var u=new r(9);return u[0]=t,u[1]=e,u[2]=n,u[3]=i,u[4]=s,u[5]=o,u[6]=a,u[7]=h,u[8]=c,u}function l(t,e,n,i,r,s,o,a,h,c){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=h,t[8]=c,t}function p(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function d(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function f(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],c=e[7],u=e[8],l=u*o-a*c,p=-u*s+a*h,d=c*s-o*h,f=n*l+i*p+r*d;return f?(f=1/f,t[0]=l*f,t[1]=(-u*i+r*c)*f,t[2]=(a*i-r*o)*f,t[3]=p*f,t[4]=(u*n-r*h)*f,t[5]=(-a*n+r*s)*f,t[6]=d*f,t[7]=(-c*n+i*h)*f,t[8]=(o*n-i*s)*f,t):null}function v(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],c=e[7],u=e[8];return t[0]=o*u-a*c,t[1]=r*c-i*u,t[2]=i*a-r*o,t[3]=a*h-s*u,t[4]=n*u-r*h,t[5]=r*s-n*a,t[6]=s*c-o*h,t[7]=i*h-n*c,t[8]=n*o-i*s,t}function m(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],c=t[8];return e*(c*s-o*h)+n*(-c*r+o*a)+i*(h*r-s*a)}function x(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=e[6],u=e[7],l=e[8],p=n[0],d=n[1],f=n[2],v=n[3],m=n[4],x=n[5],g=n[6],M=n[7],w=n[8];return t[0]=p*i+d*o+f*c,t[1]=p*r+d*a+f*u,t[2]=p*s+d*h+f*l,t[3]=v*i+m*o+x*c,t[4]=v*r+m*a+x*u,t[5]=v*s+m*h+x*l,t[6]=g*i+M*o+w*c,t[7]=g*r+M*a+w*u,t[8]=g*s+M*h+w*l,t}function g(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=e[6],u=e[7],l=e[8],p=n[0],d=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=o,t[4]=a,t[5]=h,t[6]=p*i+d*o+c,t[7]=p*r+d*a+u,t[8]=p*s+d*h+l,t}function M(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=e[6],u=e[7],l=e[8],p=Math.sin(n),d=Math.cos(n);return t[0]=d*i+p*o,t[1]=d*r+p*a,t[2]=d*s+p*h,t[3]=d*o-p*i,t[4]=d*a-p*r,t[5]=d*h-p*s,t[6]=c,t[7]=u,t[8]=l,t}function w(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function y(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function _(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function b(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function S(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function R(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,h=r+r,c=n*o,u=i*o,l=i*a,p=r*o,d=r*a,f=r*h,v=s*o,m=s*a,x=s*h;return t[0]=1-l-f,t[3]=u-x,t[6]=p+m,t[1]=u+x,t[4]=1-c-f,t[7]=d-v,t[2]=p-m,t[5]=d+v,t[8]=1-c-l,t}function z(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],c=e[7],u=e[8],l=e[9],p=e[10],d=e[11],f=e[12],v=e[13],m=e[14],x=e[15],g=n*a-i*o,M=n*h-r*o,w=n*c-s*o,y=i*h-r*a,_=i*c-s*a,b=r*c-s*h,S=u*v-l*f,R=u*m-p*f,z=u*x-d*f,E=l*m-p*v,V=l*x-d*v,P=p*x-d*m,C=g*P-M*V+w*E+y*z-_*R+b*S;return C?(C=1/C,t[0]=(a*P-h*V+c*E)*C,t[1]=(h*z-o*P-c*R)*C,t[2]=(o*V-a*z+c*S)*C,t[3]=(r*V-i*P-s*E)*C,t[4]=(n*P-r*z+s*R)*C,t[5]=(i*z-n*V-s*S)*C,t[6]=(v*b-m*_+x*y)*C,t[7]=(m*w-f*b-x*M)*C,t[8]=(f*_-v*w+x*g)*C,t):null}function E(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function V(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function P(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function C(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function T(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function q(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function X(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t}function I(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function L(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],c=t[6],u=t[7],l=t[8],p=e[0],d=e[1],f=e[2],v=e[3],m=e[4],x=e[5],g=e[6],M=e[7],w=e[8];return Math.abs(n-p)<=i*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(r-d)<=i*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(s-f)<=i*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(o-v)<=i*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(a-m)<=i*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(h-x)<=i*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(c-g)<=i*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(u-M)<=i*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(l-w)<=i*Math.max(1,Math.abs(l),Math.abs(w))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var F=x,D=T,A={};t(A,"create",(()=>Dt)),t(A,"identity",(()=>At)),t(A,"setAxisAngle",(()=>kt)),t(A,"getAxisAngle",(()=>Nt)),t(A,"getAngle",(()=>$t)),t(A,"dot",(()=>me)),t(A,"multiply",(()=>Ot)),t(A,"rotateX",(()=>Bt)),t(A,"rotateY",(()=>Ut)),t(A,"rotateZ",(()=>jt)),t(A,"calculateW",(()=>Yt)),t(A,"exp",(()=>Ht)),t(A,"ln",(()=>Gt)),t(A,"pow",(()=>Zt)),t(A,"scale",(()=>ve)),t(A,"slerp",(()=>Wt)),t(A,"random",(()=>Kt)),t(A,"invert",(()=>Jt)),t(A,"conjugate",(()=>Qt)),t(A,"fromMat3",(()=>te)),t(A,"fromEuler",(()=>ee)),t(A,"str",(()=>ne)),t(A,"clone",(()=>ce)),t(A,"fromValues",(()=>ue)),t(A,"copy",(()=>le)),t(A,"set",(()=>pe)),t(A,"add",(()=>de)),t(A,"mul",(()=>fe)),t(A,"lerp",(()=>xe)),t(A,"length",(()=>ge)),t(A,"len",(()=>Me)),t(A,"squaredLength",(()=>we)),t(A,"sqrLen",(()=>ye)),t(A,"normalize",(()=>_e)),t(A,"exactEquals",(()=>be)),t(A,"equals",(()=>Se)),t(A,"rotationTo",(()=>Re)),t(A,"sqlerp",(()=>ze)),t(A,"setAxes",(()=>Ee));var k={};function N(){var t=new r(3);return r!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function $(t){var e=new r(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function O(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function B(t,e,n){var i=new r(3);return i[0]=t,i[1]=e,i[2]=n,i}function U(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function j(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}function Y(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function H(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function G(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Z(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function W(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function K(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function J(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Q(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function tt(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function et(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function nt(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}function it(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.hypot(n,i,r)}function rt(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}function st(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function ot(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function at(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function ht(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function ct(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ut(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],h=n[2];return t[0]=r*h-s*a,t[1]=s*o-i*h,t[2]=i*a-r*o,t}function lt(t,e,n,i){var r=e[0],s=e[1],o=e[2];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=o+i*(n[2]-o),t}function pt(t,e,n,i,r,s){var o=s*s,a=o*(2*s-3)+1,h=o*(s-2)+s,c=o*(s-1),u=o*(3-2*s);return t[0]=e[0]*a+n[0]*h+i[0]*c+r[0]*u,t[1]=e[1]*a+n[1]*h+i[1]*c+r[1]*u,t[2]=e[2]*a+n[2]*h+i[2]*c+r[2]*u,t}function dt(t,e,n,i,r,s){var o=1-s,a=o*o,h=s*s,c=a*o,u=3*s*a,l=3*h*o,p=h*s;return t[0]=e[0]*c+n[0]*u+i[0]*l+r[0]*p,t[1]=e[1]*c+n[1]*u+i[1]*l+r[1]*p,t[2]=e[2]*c+n[2]*u+i[2]*l+r[2]*p,t}function ft(t,e){e=e||1;var n=2*s()*Math.PI,i=2*s()-1,r=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=i*e,t}function vt(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[3]*i+n[7]*r+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/o,t[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/o,t[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/o,t}function mt(t,e,n){var i=e[0],r=e[1],s=e[2];return t[0]=i*n[0]+r*n[3]+s*n[6],t[1]=i*n[1]+r*n[4]+s*n[7],t[2]=i*n[2]+r*n[5]+s*n[8],t}function xt(t,e,n){var i=n[0],r=n[1],s=n[2],o=n[3],a=e[0],h=e[1],c=e[2],u=r*c-s*h,l=s*a-i*c,p=i*h-r*a,d=r*p-s*l,f=s*u-i*p,v=i*l-r*u,m=2*o;return u*=m,l*=m,p*=m,d*=2,f*=2,v*=2,t[0]=a+u+d,t[1]=h+l+f,t[2]=c+p+v,t}function gt(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Mt(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function wt(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function yt(t,e){var n=t[0],i=t[1],r=t[2],s=e[0],o=e[1],a=e[2],h=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),c=h&&ct(t,e)/h;return Math.acos(Math.min(Math.max(c,-1),1))}function _t(t){return t[0]=0,t[1]=0,t[2]=0,t}function bt(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function St(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Rt(t,e){var n=t[0],r=t[1],s=t[2],o=e[0],a=e[1],h=e[2];return Math.abs(n-o)<=i*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=i*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(s-h)<=i*Math.max(1,Math.abs(s),Math.abs(h))}t(k,"create",(()=>N)),t(k,"clone",(()=>$)),t(k,"length",(()=>O)),t(k,"fromValues",(()=>B)),t(k,"copy",(()=>U)),t(k,"set",(()=>j)),t(k,"add",(()=>Y)),t(k,"subtract",(()=>H)),t(k,"multiply",(()=>G)),t(k,"divide",(()=>Z)),t(k,"ceil",(()=>W)),t(k,"floor",(()=>K)),t(k,"min",(()=>J)),t(k,"max",(()=>Q)),t(k,"round",(()=>tt)),t(k,"scale",(()=>et)),t(k,"scaleAndAdd",(()=>nt)),t(k,"distance",(()=>it)),t(k,"squaredDistance",(()=>rt)),t(k,"squaredLength",(()=>st)),t(k,"negate",(()=>ot)),t(k,"inverse",(()=>at)),t(k,"normalize",(()=>ht)),t(k,"dot",(()=>ct)),t(k,"cross",(()=>ut)),t(k,"lerp",(()=>lt)),t(k,"hermite",(()=>pt)),t(k,"bezier",(()=>dt)),t(k,"random",(()=>ft)),t(k,"transformMat4",(()=>vt)),t(k,"transformMat3",(()=>mt)),t(k,"transformQuat",(()=>xt)),t(k,"rotateX",(()=>gt)),t(k,"rotateY",(()=>Mt)),t(k,"rotateZ",(()=>wt)),t(k,"angle",(()=>yt)),t(k,"zero",(()=>_t)),t(k,"str",(()=>bt)),t(k,"exactEquals",(()=>St)),t(k,"equals",(()=>Rt)),t(k,"sub",(()=>Et)),t(k,"mul",(()=>Vt)),t(k,"div",(()=>Pt)),t(k,"dist",(()=>Ct)),t(k,"sqrDist",(()=>Tt)),t(k,"len",(()=>qt)),t(k,"sqrLen",(()=>Xt)),t(k,"forEach",(()=>It));var zt,Et=H,Vt=G,Pt=Z,Ct=it,Tt=rt,qt=O,Xt=st,It=(zt=N(),function(t,e,n,i,r,s){var o,a;for(e||(e=3),n||(n=0),a=i?Math.min(i*e+n,t.length):t.length,o=n;o<a;o+=e)zt[0]=t[o],zt[1]=t[o+1],zt[2]=t[o+2],r(zt,zt,s),t[o]=zt[0],t[o+1]=zt[1],t[o+2]=zt[2];return t});function Lt(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function Ft(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}!function(){var t,e=(t=new r(4),r!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function Dt(){var t=new r(4);return r!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function At(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function kt(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function Nt(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>i?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function $t(t,e){var n=me(t,e);return Math.acos(2*n*n-1)}function Ot(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],h=n[1],c=n[2],u=n[3];return t[0]=i*u+o*a+r*c-s*h,t[1]=r*u+o*h+s*a-i*c,t[2]=s*u+o*c+i*h-r*a,t[3]=o*u-i*a-r*h-s*c,t}function Bt(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=i*h+o*a,t[1]=r*h+s*a,t[2]=s*h-r*a,t[3]=o*h-i*a,t}function Ut(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=i*h-s*a,t[1]=r*h+o*a,t[2]=s*h+i*a,t[3]=o*h-r*a,t}function jt(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=i*h+r*a,t[1]=r*h-i*a,t[2]=s*h+o*a,t[3]=o*h-s*a,t}function Yt(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t}function Ht(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=Math.sqrt(n*n+i*i+r*r),a=Math.exp(s),h=o>0?a*Math.sin(o)/o:0;return t[0]=n*h,t[1]=i*h,t[2]=r*h,t[3]=a*Math.cos(o),t}function Gt(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=Math.sqrt(n*n+i*i+r*r),a=o>0?Math.atan2(o,s)/o:0;return t[0]=n*a,t[1]=i*a,t[2]=r*a,t[3]=.5*Math.log(n*n+i*i+r*r+s*s),t}function Zt(t,e,n){return Gt(t,e),ve(t,t,n),Ht(t,t),t}function Wt(t,e,n,r){var s,o,a,h,c,u=e[0],l=e[1],p=e[2],d=e[3],f=n[0],v=n[1],m=n[2],x=n[3];return(o=u*f+l*v+p*m+d*x)<0&&(o=-o,f=-f,v=-v,m=-m,x=-x),1-o>i?(s=Math.acos(o),a=Math.sin(s),h=Math.sin((1-r)*s)/a,c=Math.sin(r*s)/a):(h=1-r,c=r),t[0]=h*u+c*f,t[1]=h*l+c*v,t[2]=h*p+c*m,t[3]=h*d+c*x,t}function Kt(t){var e=s(),n=s(),i=s(),r=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=r*Math.sin(2*Math.PI*n),t[1]=r*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*i),t[3]=o*Math.cos(2*Math.PI*i),t}function Jt(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s,a=o?1/o:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=s*a,t}function Qt(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function te(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*s+o]-e[3*o+s])*n,t[s]=(e[3*s+r]+e[3*r+s])*n,t[o]=(e[3*o+r]+e[3*r+o])*n}return t}function ee(t,e,n,i){var r=.5*Math.PI/180;e*=r,n*=r,i*=r;var s=Math.sin(e),o=Math.cos(e),a=Math.sin(n),h=Math.cos(n),c=Math.sin(i),u=Math.cos(i);return t[0]=s*h*u-o*a*c,t[1]=o*a*u+s*h*c,t[2]=o*h*c-s*a*u,t[3]=o*h*u+s*a*c,t}function ne(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var ie,re,se,oe,ae,he,ce=function(t){var e=new r(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},ue=function(t,e,n,i){var s=new r(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=i,s},le=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},pe=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},de=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},fe=Ot,ve=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},me=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},xe=function(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=e[3];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=o+i*(n[2]-o),t[3]=a+i*(n[3]-a),t},ge=Lt,Me=ge,we=Ft,ye=we,_e=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=s*o,t},be=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},Se=function(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=e[0],h=e[1],c=e[2],u=e[3];return Math.abs(n-a)<=i*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-h)<=i*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(s-c)<=i*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(o-u)<=i*Math.max(1,Math.abs(o),Math.abs(u))},Re=(ie=N(),re=B(1,0,0),se=B(0,1,0),function(t,e,n){var i=ct(e,n);return i<-.999999?(ut(ie,re,e),qt(ie)<1e-6&&ut(ie,se,e),ht(ie,ie),kt(t,ie,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(ut(ie,e,n),t[0]=ie[0],t[1]=ie[1],t[2]=ie[2],t[3]=1+i,_e(t,t))}),ze=(oe=Dt(),ae=Dt(),function(t,e,n,i,r,s){return Wt(oe,e,r,s),Wt(ae,n,i,s),Wt(t,oe,ae,2*s*(1-s)),t}),Ee=(he=o(),function(t,e,n,i){return he[0]=n[0],he[3]=n[1],he[6]=n[2],he[1]=i[0],he[4]=i[1],he[7]=i[2],he[2]=-e[0],he[5]=-e[1],he[8]=-e[2],_e(t,te(t,he))}),Ve={};Object.defineProperty(Ve,"__esModule",{value:!0});var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.default=class{constructor(){this._pose=null,this._view=null,this.poseMatrix=new p5.Matrix,this.initialMVMatrix=new p5.Matrix,this.leftPMatrix=new p5.Matrix,this.rightPMatrix=new p5.Matrix,this.position=new p5.Vector(0,0,0),this.setPosition=function(t,e,n){this.position.set(t,e,n),p5.instance._renderer.translate(-t,-e,-n)}}set pose(t){this._pose=t,this.poseMatrix.set(t.poseModelMatrix)}get pose(){return this._pose}set view(t){this._view=t,p5.instance._renderer.uMVMatrix.set(this._view.transform.inverse.matrix),p5.instance._renderer.uPMatrix.set(this._view.projectionMatrix),p5.instance._renderer._curCamera.cameraMatrix.set(p5.Matrix.identity().mult(this._view.transform.inverse.matrix)),"left"===t.eye?this.leftPMatrix.set(p5.instance._renderer.uPMatrix.copy()):this.rightPMatrix.set(p5.instance._renderer.uPMatrix.copy())}get view(){return this._view}getRayFromScreen(t,e){const n={origin:new p5.Vector(0,0,0),direction:new p5.Vector};let i=this.poseMatrix.copy();i.transpose(i),i=i.mat4,n.origin.x=i[3],n.origin.y=i[7],n.origin.z=i[11];let r=this.initialMVMatrix.copy();r.transpose(r),r=r.mat4;const s=n.origin.copy();n.origin.x=r[0]*s.x+r[1]*s.y+r[2]*s.z+r[3],n.origin.y=r[4]*s.x+r[5]*s.y+r[6]*s.z+r[7],n.origin.z=r[8]*s.x+r[9]*s.y+r[10]*s.z+r[11];const o=new p5.Vector(t,e,-1);let a=new p5.Matrix;a.invert(this.leftPMatrix.copy()),a.transpose(a),a=a.mat4;const h=o.copy();o.x=a[0]*h.x+a[1]*h.y+a[2]*h.z,o.y=a[4]*h.x+a[5]*h.y+a[6]*h.z,o.normalize();const c=new p5.Vector(t,e,-1);let u=new p5.Matrix;u.invert(this.rightPMatrix.copy()),u.transpose(u),u=u.mat4;const l=c.copy();return c.x=u[0]*l.x+u[1]*l.y+u[2]*l.z,c.y=u[4]*l.x+u[5]*l.y+u[6]*l.z,c.normalize(),n.direction=p5.Vector.add(o,c).normalize(),n}};var Ce=Ae(Pe),Te={};Object.defineProperty(Te,"__esModule",{value:!0});Te.default=class{constructor(t){this.options=t||{},this.options.color=t.color||"rgb(237, 34, 93)",this.options.background=t.background||"white",this.options.opacity=t.opacity||.95,this.options.disabledOpacity=t.disabledOpacity||.5,this.options.height=t.height||window.innerWidth/5,this.options.fontSize=t.fontSize||this.options.height/3,this.options.corners=t.corners||"square",this.options.cssprefix=t.cssprefix||"webvr-ui",this.options.textEnterXRTitle=t.textEnterXRTitle||"ENTER XR",this.options.textXRNotFoundTitle=t.textXRNotFoundTitle||"XR NOT FOUND",this.options.textExitXRTitle=t.textExitXRTitle||"EXIT XR",this.options.onRequestSession=t.onRequestSession||function(){},this.options.onEndSession=t.onEndSession||function(){},this.options.injectCSS=!1!==t.injectCSS,this.options=t,this.device=null,this.session=null,this.logoScale=1.2,this._WEBXR_UI_CSS_INJECTED={},this.domElement=t.domElement||this.__createDefaultView(t),this.__defaultDisplayStyle=this.domElement.style.display||"initial",this.domElement.addEventListener("click",(()=>this.__onXRButtonClicked())),this.__forceDisabled=!1,this.__setDisabledAttribute(!0),this.setTitle(this.options.textXRNotFoundTitle)}__generateInnerHTML(t,e){const n=e*this.logoScale;return`<button class="${t}-button">\n    <div class="${t}-title"></div>\n    <div class="${t}-logo" >${this.__generateXRIconString(t,n)+this.__generateNoXRIconString(t,n)}</div>\n    </button>`}__createDefaultView(t){t.injectCSS&&(this._WEBXR_UI_CSS_INJECTED[t.cssprefix]||(this.__injectCSS(this.__generateCSS(t)),this._WEBXR_UI_CSS_INJECTED[t.cssprefix]=!0));const e=document.createElement("div");return e.innerHTML=this.__generateInnerHTML(t.cssprefix,t.fontSize),e.firstChild}__createXRIcon(t,e){const n=document.createElement("div");return n.innerHTML=generateXRIconString(t,e),n.firstChild}__createNoXRIcon(t,e){const n=document.createElement("div");return n.innerHTML=generateNoXRIconString(t,e),n.firstChild}__generateXRIconString(t,e){return`<svg class="${t}-svg" version="1.1" x="0px" y="0px"\n        width="${28/18*e}px" height="${e}px" viewBox="0 0 28 18" xml:space="preserve">\n        <path d="M26.8,1.1C26.1,0.4,25.1,0,24.2,0H3.4c-1,0-1.7,0.4-2.4,1.1C0.3,1.7,0,2.7,0,3.6v10.7\n        c0,1,0.3,1.9,0.9,2.6C1.6,17.6,2.4,18,3.4,18h5c0.7,0,1.3-0.2,1.8-0.5c0.6-0.3,1-0.8,1.3-1.4l\n        1.5-2.6C13.2,13.1,13,13,14,13v0h-0.2 h0c0.3,0,0.7,0.1,0.8,0.5l1.4,2.6c0.3,0.6,0.8,1.1,1.3,\n        1.4c0.6,0.3,1.2,0.5,1.8,0.5h5c1,0,2-0.4,2.7-1.1c0.7-0.7,1.2-1.6,1.2-2.6 V3.6C28,2.7,27.5,\n        1.7,26.8,1.1z M7.4,11.8c-1.6,0-2.8-1.3-2.8-2.8c0-1.6,1.3-2.8,2.8-2.8c1.6,0,2.8,1.3,2.8,2.8\n        C10.2,10.5,8.9,11.8,7.4,11.8z M20.1,11.8c-1.6,0-2.8-1.3-2.8-2.8c0-1.6,1.3-2.8,2.8-2.8C21.7\n        ,6.2,23,7.4,23,9 C23,10.5,21.7,11.8,20.1,11.8z"/>\n    </svg>`}__generateNoXRIconString(t,e){const n=28/18;return`<svg class="${t}-svg-error" x="0px" y="0px"\n        width="${n*e}px" height="${n*e}px" viewBox="0 0 28 28" xml:space="preserve">\n        <path d="M17.6,13.4c0-0.2-0.1-0.4-0.1-0.6c0-1.6,1.3-2.8,2.8-2.8s2.8,1.3,2.8,2.8s-1.3,2.8-2.8,2.8\n        c-0.2,0-0.4,0-0.6-0.1l5.9,5.9c0.5-0.2,0.9-0.4,1.3-0.8\n        c0.7-0.7,1.1-1.6,1.1-2.5V7.4c0-1-0.4-1.9-1.1-2.5c-0.7-0.7-1.6-1-2.5-1\n        H8.1 L17.6,13.4z"/>\n        <path d="M10.1,14.2c-0.5,0.9-1.4,1.4-2.4,1.4c-1.6,0-2.8-1.3-2.8-2.8c0-1.1,0.6-2,1.4-2.5\n        L0.9,5.1 C0.3,5.7,0,6.6,0,7.5v10.7c0,1,0.4,1.8,1.1,2.5c0.7,0.7,1.6,1,2.5,1\n        h5c0.7,0,1.3-0.1,1.8-0.5c0.6-0.3,1-0.8,1.3-1.4l1.3-2.6 L10.1,14.2z"/>\n        <path d="M25.5,27.5l-25-25C-0.1,2-0.1,1,0.5,0.4l0,0C1-0.1,2-0.1,2.6,0.4l25,25c0.6,0.6,0.6,1.5\n        ,0,2.1l0,0 C27,28.1,26,28.1,25.5,27.5z"/>\n    </svg>`}setDevice(t){return this.device=t,this}setSession(t){return this.session=t,this.__updateButtonState(),this}setTitle(t){return this.domElement.title=t,this.ifChild(this.domElement,this.options.cssprefix,"title",(e=>{t?(e.innerText=t,e.style.display="initial"):e.style.display="none"})),this}__generateCSS(t){const{height:e}=t,n=t.background?t.background:t.color,i=t.cssprefix;let r;return r="round"===t.corners?t.height/2:"square"===t.corners?2:t.corners,`\n      @font-face {\n          font-family: 'Karla';\n          font-style: normal;\n          font-weight: 400;\n          src: local('Karla'), local('Karla-Regular'),\n              url(https://fonts.gstatic.com/s/karla/v5/31P4mP32i98D9CEnGyeX9Q.woff2) format('woff2');\n          unicode-range: U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;\n      }\n      @font-face {\n          font-family: 'Karla';\n          font-style: normal;\n          font-weight: 400;\n          src: local('Karla'), local('Karla-Regular'),\n              url(https://fonts.gstatic.com/s/karla/v5/Zi_e6rBgGqv33BWF8WTq8g.woff2) format('woff2');\n          unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074,\n                        U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;\n      }\n\n      button.${i}-button {\n          font-family: 'Karla', sans-serif;\n\n          border: ${n} 2px solid;\n          border-radius: ${r}px;\n          box-sizing: border-box;\n          background: ${t.background?t.background:"none"};\n          opacity: ${t.opacity};\n          height: ${e}px;\n          min-width: ${9.6*t.fontSize}px;\n          display: inline-block;\n          position: absolute;\n          top: 5%;\n          left: 15%;\n          cursor: pointer;\n      }\n\n      button.${i}-button:focus {\n        outline: none;\n      }\n\n      /*\n      * Logo\n      */\n\n      .${i}-logo {\n          width: ${e}px;\n          height: ${e}px;\n          position: absolute;\n          top:0px;\n          left:0px;\n          width: ${e-4}px;\n          height: ${e-4}px;\n      }\n      .${i}-svg {\n          fill: ${t.color};\n          margin-top: ${(e-t.fontSize*this.logoScale)/2-2}px;\n          margin-left: ${e/3}px;\n      }\n      .${i}-svg-error {\n          fill: ${t.color};\n          display:none;\n          margin-top: ${(e-28/18*t.fontSize*this.logoScale)/2-2}px;\n          margin-left: ${e/3}px;\n      }\n\n\n      /*\n      * Title\n      */\n\n      .${i}-title {\n          color: ${t.color};\n          position: relative;\n          font-size: ${t.fontSize}px;\n          padding-left: ${1.05*e}px;\n          padding-right: ${r-10<5?e/3:r-10}px;\n      }\n\n      /*\n      * disabled\n      */\n\n      button.${i}-button[disabled=true] {\n          opacity: ${t.disabledOpacity};\n      }\n\n      button.${i}-button[disabled=true] > .${i}-logo > .${i}-svg {\n          display:none;\n      }\n\n      button.${i}-button[disabled=true] > .${i}-logo > .${i}-svg-error {\n          display:initial;\n      }\n    `}__injectCSS(t){const e=document.createElement("style");e.innerHTML=t;const n=document.getElementsByTagName("head")[0];n.insertBefore(e,n.firstChild)}ifChild(t,e,n,i){const r=t.querySelector(`.${e}-${n}`);r&&i(r)}setTooltip(t){return this.domElement.title=t,this}show(){return this.domElement.style.display=this.__defaultDisplayStyle,this}hide(){return this.domElement.style.display="none",this}enable(){return this.__setDisabledAttribute(!1),this.__forceDisabled=!1,this}disable(){return this.__setDisabledAttribute(!0),this.__forceDisabled=!0,this}remove(){this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement)}setAvailable(t,e){if(t){const t=`Enter ${e}`;this.setTitle(t),this.setTooltip(t),this.enable(),console.log(`${e} supported`),this.setDevice(!0)}else if("VR"===e)console.log("VR not supported. Falling back to inline mode."),this.hide();else{const t=`${e} not supported`;this.setTitle(t),this.setTooltip(t),this.disable(),console.log(`${e} not supported`)}}__setDisabledAttribute(t){t||this.__forceDisabled?this.domElement.setAttribute("disabled","true"):this.domElement.removeAttribute("disabled")}__onXRButtonClicked(){this.session?this.options.onRequestSession(this.device):this.device&&("undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission&&DeviceMotionEvent.requestPermission().then((t=>{"granted"===t&&window.addEventListener("devicemotion",(()=>{}))})).catch(console.error),"undefined"!=typeof DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission&&DeviceOrientationEvent.requestPermission().then((t=>{"granted"===t&&window.addEventListener("deviceorientation",(()=>{}))})).catch(console.error),this.options.onRequestSession(this.device))}};var qe=Ae(Te),Xe={};Object.defineProperty(Xe,"__esModule",{value:!0});var Ie={};
/**
 * @license Quaternion.js v1.4.0 27/03/2022
 *
 * Copyright (c) 2022, Robert Eisele (robert@xarg.org)
 * Licensed under the MIT license.
 **/!function(t){"use strict";function e(t,e){var n=Math.abs(t),i=Math.abs(e);return 0===t?Math.log(i):0===e?Math.log(n):n<3e3&&i<3e3?.5*Math.log(t*t+e*e):(t/=2,e/=2,.5*Math.log(t*t+e*e)+Math.LN2)}var n={w:1,x:0,y:0,z:0};function i(t,e,i,r,s){if(void 0!==s)return t.w=e,t.x=i,t.y=r,void(t.z=s);if("object"==typeof e&&void 0===r){if("w"in e||"x"in e||"y"in e||"z"in e)return t.w=e.w||0,t.x=e.x||0,t.y=e.y||0,void(t.z=e.z||0);if("re"in e&&"im"in e)return t.w=e.re,t.x=e.im,t.y=0,void(t.z=0);if(4===e.length)return t.w=e[0],t.x=e[1],t.y=e[2],void(t.z=e[3]);if(3===e.length)return t.w=0,t.x=e[0],t.y=e[1],void(t.z=e[2]);throw new Error("Invalid object")}if("string"!=typeof e||void 0!==r)void 0===e&&t!==n?(t.w=1,t.x=t.y=t.z=0):(t.w=e||0,i&&3===i.length?(t.x=i[0],t.y=i[1],t.z=i[2]):(t.x=i||0,t.y=r||0,t.z=s||0));else{var o=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),a=1,h=0,c={i:"x",j:"y",k:"z"};if(null===o)throw new Error("Parse error");t.w=t.x=t.y=t.z=0;for(var u=0;u<o.length;u++){var l=o[u],p=o[u+1];if(" "===l||"\t"===l||"\n"===l);else if("+"===l)a++;else if("-"===l)h++;else{if(a+h===0)throw new Error("Parse error"+l);var d=c[l];if(void 0!==d)" "===p||isNaN(p)?l="1":(l=p,u++);else{if(isNaN(l))throw new Error("Parser error");void 0!==(d=c[p])&&u++}t[d||"w"]+=parseFloat((h%2?"-":"")+l),a=h=0}}if(a+h>0)throw new Error("Parser error")}}function r(t,e,n){var i="";return 0!==t&&(""!==n?i+=t<0?" - ":" + ":t<0&&(i+="-"),1===(t=Math.abs(t))&&""!==e||(i+=t),i+=e),i}function s(t,e,n,r){if(!(this instanceof s))return new s(t,e,n,r);i(this,t,e,n,r)}s.prototype={w:1,x:0,y:0,z:0,add:function(t,e,r,o){return i(n,t,e,r,o),new s(this.w+n.w,this.x+n.x,this.y+n.y,this.z+n.z)},sub:function(t,e,r,o){return i(n,t,e,r,o),new s(this.w-n.w,this.x-n.x,this.y-n.y,this.z-n.z)},neg:function(){return new s(-this.w,-this.x,-this.y,-this.z)},norm:function(){var t=this.w,e=this.x,n=this.y,i=this.z;return Math.sqrt(t*t+e*e+n*n+i*i)},normSq:function(){var t=this.w,e=this.x,n=this.y,i=this.z;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.w,e=this.x,n=this.y,i=this.z,r=Math.sqrt(t*t+e*e+n*n+i*i);return r<s.EPSILON?s.ZERO:new s(t*(r=1/r),e*r,n*r,i*r)},mul:function(t,e,r,o){i(n,t,e,r,o);var a=this.w,h=this.x,c=this.y,u=this.z,l=n.w,p=n.x,d=n.y,f=n.z;return new s(a*l-h*p-c*d-u*f,a*p+h*l+c*f-u*d,a*d+c*l+u*p-h*f,a*f+u*l+h*d-c*p)},scale:function(t){return new s(this.w*t,this.x*t,this.y*t,this.z*t)},dot:function(t,e,r,s){return i(n,t,e,r,s),this.w*n.w+this.x*n.x+this.y*n.y+this.z*n.z},inverse:function(){var t=this.w,e=this.x,n=this.y,i=this.z,r=t*t+e*e+n*n+i*i;return 0===r?s.ZERO:new s(t*(r=1/r),-e*r,-n*r,-i*r)},div:function(t,e,r,o){i(n,t,e,r,o);var a=this.w,h=this.x,c=this.y,u=this.z,l=n.w,p=n.x,d=n.y,f=n.z,v=l*l+p*p+d*d+f*f;return 0===v?s.ZERO:new s((a*l+h*p+c*d+u*f)*(v=1/v),(h*l-a*p-c*f+u*d)*v,(c*l-a*d-u*p+h*f)*v,(u*l-a*f-h*d+c*p)*v)},conjugate:function(){return new s(this.w,-this.x,-this.y,-this.z)},exp:function(){var t=this.w,e=this.x,n=this.y,i=this.z,r=Math.sqrt(e*e+n*n+i*i),o=Math.exp(t),a=o/r*Math.sin(r);return 0===r?new s(o,0,0,0):new s(o*Math.cos(r),e*a,n*a,i*a)},log:function(){var t=this.w,n=this.x,i=this.y,r=this.z;if(0===i&&0===r)return new s(e(t,n),Math.atan2(n,t),0,0);var o=n*n+i*i+r*r+t*t,a=Math.sqrt(n*n+i*i+r*r),h=Math.atan2(a,t)/a;return new s(.5*Math.log(o),n*h,i*h,r*h)},pow:function(t,r,o,a){if(i(n,t,r,o,a),0===n.y&&0===n.z){if(1===n.w&&0===n.x)return this;if(0===n.w&&0===n.x)return s.ONE;if(0===this.y&&0===this.z){var h=this.w,c=this.x;if(0===h&&0===c)return s.ZERO;var u=Math.atan2(c,h),l=e(h,c);if(0===n.x){if(0===c&&h>=0)return new s(Math.pow(h,n.w),0,0,0);if(0===h)switch(n.w%4){case 0:return new s(Math.pow(c,n.w),0,0,0);case 1:return new s(0,Math.pow(c,n.w),0,0);case 2:return new s(-Math.pow(c,n.w),0,0,0);case 3:return new s(0,-Math.pow(c,n.w),0,0)}}return h=Math.exp(n.w*l-n.x*u),c=n.x*l+n.w*u,new s(h*Math.cos(c),h*Math.sin(c),0,0)}}return this.log().mul(n).exp()},equals:function(t,e,r,o){i(n,t,e,r,o);var a=s.EPSILON;return Math.abs(n.w-this.w)<a&&Math.abs(n.x-this.x)<a&&Math.abs(n.y-this.y)<a&&Math.abs(n.z-this.z)<a},isFinite:function(){return isFinite(this.w)&&isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)},isNaN:function(){return isNaN(this.w)||isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},toString:function(){var t=this.w,e=this.x,n=this.y,i=this.z,s="";return isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i)?"NaN":(s=r(t,"",s),s+=r(e,"i",s),s+=r(n,"j",s),""===(s+=r(i,"k",s))?"0":s)},real:function(){return this.w},imag:function(){return[this.x,this.y,this.z]},toVector:function(){return[this.w,this.x,this.y,this.z]},toMatrix:function(t){var e=this.w,n=this.x,i=this.y,r=this.z,s=e*n,o=e*i,a=e*r,h=n*n,c=n*i,u=n*r,l=i*i,p=i*r,d=r*r;return t?[[1-2*(l+d),2*(c-a),2*(u+o)],[2*(c+a),1-2*(h+d),2*(p-s)],[2*(u-o),2*(p+s),1-2*(h+l)]]:[1-2*(l+d),2*(c-a),2*(u+o),2*(c+a),1-2*(h+d),2*(p-s),2*(u-o),2*(p+s),1-2*(h+l)]},toMatrix4:function(t){var e=this.w,n=this.x,i=this.y,r=this.z,s=e*n,o=e*i,a=e*r,h=n*n,c=n*i,u=n*r,l=i*i,p=i*r,d=r*r;return t?[[1-2*(l+d),2*(c-a),2*(u+o),0],[2*(c+a),1-2*(h+d),2*(p-s),0],[2*(u-o),2*(p+s),1-2*(h+l),0],[0,0,0,1]]:[1-2*(l+d),2*(c-a),2*(u+o),0,2*(c+a),1-2*(h+d),2*(p-s),0,2*(u-o),2*(p+s),1-2*(h+l),0,0,0,0,1]},toEuler:function(){var t=this.w,e=this.x,n=this.y,i=this.z,r=2*(t*n-i*e);return{roll:Math.atan2(2*(t*e+n*i),1-2*(e*e+n*n)),pitch:r>=1?Math.PI/2:r<=-1?-Math.PI/2:Math.asin(r),yaw:Math.atan2(2*(t*i+e*n),1-2*(n*n+i*i))}},clone:function(){return new s(this)},rotateVector:function(t){var e=this.w,n=this.x,i=this.y,r=this.z,s=t[0],o=t[1],a=t[2],h=2*(i*a-r*o),c=2*(r*s-n*a),u=2*(n*o-i*s);return[s+e*h+i*u-r*c,o+e*c+r*h-n*u,a+e*u+n*c-i*h]},slerp:function(t,e,r,o){i(n,t,e,r,o);var a=this.w,h=this.x,c=this.y,u=this.z,l=n.w,p=n.x,d=n.y,f=n.z,v=a*l+h*p+c*d+u*f;if(v<0&&(a=-a,h=-h,c=-c,u=-u,v=-v),v>=1-s.EPSILON)return function(t){return new s(a+t*(l-a),h+t*(p-h),c+t*(d-c),u+t*(f-u)).normalize()};var m=Math.acos(v),x=Math.sin(m);return function(t){var e=m*t,n=Math.sin(e),i=Math.cos(e)-v*n/x,r=n/x;return new s(i*a+r*l,i*h+r*p,i*c+r*d,i*u+r*f)}}},s.ZERO=new s(0,0,0,0),s.ONE=new s(1,0,0,0),s.I=new s(0,1,0,0),s.J=new s(0,0,1,0),s.K=new s(0,0,0,1),s.EPSILON=1e-16,s.fromAxisAngle=function(t,e){var n=.5*e,i=t[0],r=t[1],o=t[2],a=Math.sin(n),h=Math.cos(n),c=a/Math.sqrt(i*i+r*r+o*o);return new s(h,i*c,r*c,o*c)},s.fromBetweenVectors=function(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],a=e[1],h=e[2],c=n*o+i*a+r*h;s.EPSILON;var u=i*h-r*a,l=r*o-n*h,p=n*a-i*o;return new s(c+Math.sqrt(c*c+u*u+l*l+p*p),u,l,p).normalize()},s.random=function(){var t=Math.random(),e=Math.random(),n=Math.random(),i=Math.sqrt(1-t),r=Math.sqrt(t);return new s(r*Math.cos(2*Math.PI*n),i*Math.sin(2*Math.PI*e),i*Math.cos(2*Math.PI*e),r*Math.sin(2*Math.PI*n))},s.fromEuler=function(t,e,n,i){var r=.5*t,o=.5*e,a=.5*n,h=Math.cos(r),c=Math.cos(o),u=Math.cos(a),l=Math.sin(r),p=Math.sin(o),d=Math.sin(a);return void 0===i||"ZXY"===i?new s(h*c*u-l*p*d,h*u*p-c*l*d,h*c*d+u*l*p,c*u*l+h*p*d):"XYZ"===i||"RPY"===i?new s(h*c*u-l*p*d,c*u*l+h*p*d,h*u*p-c*l*d,h*c*d+u*l*p):"YXZ"===i?new s(h*c*u+l*p*d,h*u*p+c*l*d,c*u*l-h*p*d,h*c*d-u*l*p):"ZYX"===i||"YPR"===i?new s(h*c*u+l*p*d,h*c*d-u*l*p,h*u*p+c*l*d,c*u*l-h*p*d):"YZX"===i?new s(h*c*u-l*p*d,h*c*d+u*l*p,c*u*l+h*p*d,h*u*p-c*l*d):"XZY"===i?new s(h*c*u+l*p*d,c*u*l-h*p*d,h*c*d-u*l*p,h*u*p+c*l*d):null},s.fromMatrix=function(t){if(9===t.length)var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],h=t[6],c=t[7],u=t[8];else e=t[0][0],n=t[0][1],i=t[0][2],r=t[1][0],o=t[1][1],a=t[1][2],h=t[2][0],c=t[2][1],u=t[2][2];var l,p=e+o+u;return p>0?new s(.25*(l=2*Math.sqrt(p+1)),(c-a)/l,(i-h)/l,(r-n)/l):e>o&e>u?new s((c-a)/(l=2*Math.sqrt(1+e-o-u)),.25*l,(n+r)/l,(i+h)/l):o>u?new s((i-h)/(l=2*Math.sqrt(1+o-e-u)),(n+r)/l,.25*l,(a+c)/l):new s((r-n)/(l=2*Math.sqrt(1+u-e-o)),(i+h)/l,(a+c)/l,.25*l)},"function"==typeof define&&define.amd?define([],(function(){return s})):(Object.defineProperty(s,"__esModule",{value:!0}),s.default=s,s.Quaternion=s,Ie=s)}();var Le,Fe=(Le=Ie)&&Le.__esModule?Le:{default:Le};Xe.default=class{constructor(t,e,i){this._inputSource=t,this._targetRayPose=e.getPose(this._inputSource.targetRaySpace,i),this._pose=void 0,this.gamepad=t.gamepad,this._dir=k.create();const r=n.create(),s=k.create();this._dir[2]=-1,this._targetRayPose&&(k.transformMat4(s,s,this._targetRayPose.transform.matrix),n.fromMat4(r,this._targetRayPose.transform.matrix),k.transformMat3(this._dir,this._dir,r)),this.direction=this._dir}get direction(){return new p5.Vector(this._dir[0],this._dir[1],this._dir[2])}set direction(t){this._dir=k.copy(this._dir,t),k.normalize(this._dir,this._dir),this.inv_dir=k.fromValues(1/this._dir[0],1/this._dir[1],1/this._dir[2]),this.sign=[this.inv_dir[0]<0?1:0,this.inv_dir[1]<0?1:0,this.inv_dir[2]<0?1:0]}get pose(){return this.updatePose(),this._pose.transform.matrix}get position(){this.updatePose();const t=this._pose?.transform?.position;return new p5.Vector(t.x,t.y,t.z)}get rotation(){if(this.updatePose(),this._pose){const{x:t,y:e,z:n,w:i}=this._pose?.transform?.orientation,r=new Fe.default(t,e,n,i).toEuler();return p5.instance.angleMode===RADIANS?new p5.Vector(-r.yaw,r.pitch,-r.roll):new p5.Vector(p5.toDegrees(-r.yaw),p5.toDegrees(r.pitch),p5.toDegrees(-r.roll))}return new p5.Vector(0,0,0)}get trigger(){return this.updateGamepad(),this.gamepad?.buttons[0]}get grip(){return this.updateGamepad(),this.gamepad.buttons[1]}get touchpad(){return this.updateGamepad(),this.gamepad.buttons[2]}get thumbstick(){return this.updateGamepad(),this.gamepad.buttons[3]}get touchpad2D(){return this.updateGamepad(),new p5.Vector(this.gamepad.axes[0],this.gamepad.axes[1])}get thumbstick2D(){return this.updateGamepad(),new p5.Vector(this.gamepad.axes[2],this.gamepad.axes[3])}updatePose(){return this._pose=window.p5xr.instance.frame.getPose(this._inputSource.gripSpace,window.p5xr.instance.xrRefSpace),this._pose}updateGamepad(){return this.gamepad=this._inputSource.gamepad,this.gamepad}};var De=Ae(Xe);function Ae(t){return t&&t.__esModule?t:{default:t}}Ve.default=class{constructor(t){this.xrDevice=null,this.xrButton=t||null,this.isVR=null,this.hasImmersive=null,this.xrSession=null,this.xrRefSpace=null,this.xrViewerSpace=null,this.xrHitTestSource=null,this.frame=null,this.gl=null,this.curClearColor=color(255,255,255),this.viewer=new Ce.default}__removeLoadingElement(){const t=document.getElementById(window._loadingScreenId);t&&t.parentNode.removeChild(t)}__updateXR(){const t=p5.instance._renderer;t.ambientLightColors.length=0,t.specularColors=[1,1,1],t.directionalLightDirections.length=0,t.directionalLightDiffuseColors.length=0,t.directionalLightSpecularColors.length=0,t.pointLightPositions.length=0,t.pointLightDiffuseColors.length=0,t.pointLightSpecularColors.length=0,t.spotLightPositions.length=0,t.spotLightDirections.length=0,t.spotLightDiffuseColors.length=0,t.spotLightSpecularColors.length=0,t.spotLightAngle.length=0,t.spotLightConc.length=0,t._enableLighting=!1,t._tint=[255,255,255,255]}__setupCanvas(){createCanvas(windowWidth,windowHeight,WEBGL),p5.instance._setupDone=!0}__createButton(){p5.instance._incrementPreload(),this.__setupCanvas(),this.__removeLoadingElement(),this.xrButton=new qe.default({onRequestSession:this.__onXRButtonClicked.bind(this),onEndSession:this.__onSessionEnded.bind(this),textEnterXRTitle:"LOADING"});let t=document.querySelector("header");t||(t=document.createElement("header"),document.querySelector("body").appendChild(t)),t.appendChild(this.xrButton.domElement),this.__sessionCheck()}async __sessionCheck(){if(navigator?.xr){console.log("XR Available");const t=this.isVR?"VR":"AR",e=this.isVR?"immersive-vr":"immersive-ar",n=await navigator.xr.isSessionSupported(e);this.xrButton.setAvailable(n,t)}else console.log("XR Not Available"),this.xrButton.disable()}__onXRFrame(t,e){const n=this.xrSession=e.session;if(null===n||null===this.gl)return;n.requestAnimationFrame(this.__onXRFrame.bind(this));let i=this.xrRefSpace;this.isVR&&!this.isImmersive&&(i=this.getAdjustedRefSpace(this.xrRefSpace));const r=e.getViewerPose(this.xrRefSpace),s=n.renderState.baseLayer;if(this.frame=e,r){this.viewer.pose=e.getViewerPose(i),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,s.framebuffer),this.isVR&&this.clearVR();let t=0;for(const e of this.viewer.pose.views){this.viewer.view=e;const n=this.isImmersive?1:pixelDensity(),i=s.getViewport(this.viewer.view);this.gl.viewport(i.x,i.y,i.width*n,i.height*n),this.__updateViewport(i),this.__drawEye(t),t++}}}__updateViewport(t){p5.instance._renderer._viewport[0]=t.x,p5.instance._renderer._viewport[1]=t.y,p5.instance._renderer._viewport[2]=t.width,p5.instance._renderer._viewport[3]=t.height}__drawEye(t){const e=window,n=e.setup,i=e.draw,r=e.calculate;if(this.isVR){if(0===t){"function"==typeof r&&r();const t=window.performance.now();p5.instance.deltaTime=t-p5.instance._lastFrameTime,p5.instance._frameRate=1e3/p5.instance.deltaTime,p5.instance._setProperty("deltaTime",p5.instance.deltaTime),p5.instance._lastFrameTime=t,e._setProperty("frameCount",e.frameCount+1)}}else scale(.01);if(p5.instance._renderer.isP3D){if("function"==typeof i){void 0===n&&e.scale(e._pixelDensity,e._pixelDensity),this.__updateXR(),p5.instance._inUserDraw=!0;try{i()}finally{p5.instance._inUserDraw=!1}}}else console.error("Sketch does not have 3D Renderer")}__getXRInput(t){let e;return this.xrSession.inputSources.forEach((n=>{n.handedness===t&&(e=new De.default(n,this.frame,this.xrRefSpace))})),e}__onSessionEnded(){this.isVR?this.isImmersive&&(console.log("Exiting immersive session"),this.isImmersive=!1,this.__sessionCheck(),console.log("Requesting new session"),navigator.xr.requestSession("inline").then(this.__startSketch.bind(this))):(this.xrHitTestSource.cancel(),this.xrHitTestSource=null),this.isImmersive&&this.hasImmersive&&(this.isImmersive=!1)}printUnsupportedMessage(){console.warn("Your browser/hardware does not work with AR Mode currently. This is undergoing heavy development currently.You may be able to fix this by enabling WebXR flags in Chrome.")}remove(){this.xrButton&&this.xrButton.remove(),window.p5xr.instance=null}get instance(){return window.p5xr.instance}set instance(t){return window.p5xr.instance=t,window.p5xr.instance}};var ke=function(t){return t&&t.__esModule?t:{default:t}}(Ve);class Ne extends ke.default{constructor(){super(),this.isVR=!0,this.isImmersive=!1,this.lookYaw=0,this.lookPitch=0,this.LOOK_SPEED=.0025,this.primaryTouch=void 0,this.prevTouchX=void 0,this.prevTouchY=void 0,navigator?.xr&&navigator.xr.requestSession("inline").then(this.__startSketch.bind(this))}__initVR(){this.__createButton()}__startSketch(t){this.xrSession=t,this.canvas=p5.instance.canvas,this.canvas.style.visibility="visible",this.xrSession.addEventListener("end",this.__onSessionEnded.bind(this)),"function"==typeof window.setup&&(window.setup(),p5.instance._millisStart=window.performance.now());const e=this.isImmersive?"local":"viewer";this.xrSession.requestReferenceSpace(e).then((t=>{this.xrRefSpace=t,this.xrSession.requestAnimationFrame(this.__onXRFrame.bind(this)),this.isImmersive||(this.xrSession.updateRenderState({baseLayer:new XRWebGLLayer(this.xrSession,this.gl),inlineVerticalFieldOfView:Math.PI/180*70}),this.addInlineViewListeners(this.canvas))})),this.__onRequestSession()}resetXR(){this.xrDevice=null,this.xrSession=null,this.xrRefSpace=null,this.xrViewerSpace=null,this.xrHitTestSource=null,this.gl=null,this.frame=null}__onXRButtonClicked(){this.hasImmersive?(console.log("Requesting session with mode: immersive-vr"),this.isImmersive=!0,this.resetXR(),navigator.xr.requestSession("immersive-vr").then(this.__startSketch.bind(this))):this.xrButton.hide()}__onRequestSession(){p5.instance._renderer._curCamera.cameraType="custom";const t=this.isImmersive?"local":"viewer";this.gl=this.canvas.getContext("webgl"),this.gl.makeXRCompatible().then((()=>{this.xrSession.requestReferenceSpace(t).then((t=>{this.xrRefSpace=t})),this.xrSession.updateRenderState({baseLayer:new XRWebGLLayer(this.xrSession,this.gl)})})).catch((t=>{console.log(t)})),this.xrSession.requestAnimationFrame(this.__onXRFrame.bind(this))}clearVR(){null!==this.curClearColor&&(p5.instance.background(this.curClearColor),this.gl.clear(this.gl.DEPTH_BUFFER_BIT))}getAdjustedRefSpace(t){const e=A.create();A.rotateX(e,e,-this.lookPitch),A.rotateY(e,e,-this.lookYaw);const n=new XRRigidTransform({x:0,y:0,z:0},{x:e[0],y:e[1],z:e[2],w:e[3]});return t.getOffsetReferenceSpace(n)}rotateInlineView(t,e){this.lookYaw+=t*this.LOOK_SPEED,this.lookPitch+=e*this.LOOK_SPEED,this.lookPitch<.5*-Math.PI&&(this.lookPitch=.5*-Math.PI),this.lookPitch>.5*Math.PI&&(this.lookPitch=.5*Math.PI)}addInlineViewListeners(){this.canvas.addEventListener("mousemove",(t=>{t.buttons&&this.rotateInlineView(t.movementX,t.movementY)})),this.canvas.addEventListener("touchstart",(t=>{if(void 0===this.primaryTouch){const e=t.changedTouches[0];this.primaryTouch=e.identifier,this.prevTouchX=e.pageX,this.prevTouchY=e.pageY}})),this.canvas.addEventListener("touchend",(t=>{for(const e of t.changedTouches)this.primaryTouch===e.identifier&&(this.primaryTouch=void 0,this.rotateInlineView(e.pageX-this.prevTouchX,e.pageY-this.prevTouchY))})),this.canvas.addEventListener("touchcancel",(t=>{for(const e of t.changedTouches)this.primaryTouch===e.identifier&&(this.primaryTouch=void 0)})),this.canvas.addEventListener("touchmove",(t=>{for(const e of t.changedTouches)this.primaryTouch===e.identifier&&(this.rotateInlineView(e.pageX-this.prevTouchX,e.pageY-this.prevTouchY),this.prevTouchX=e.pageX,this.prevTouchY=e.pageY)}))}}e.default=Ne;var $e=Ze(e),Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});var Be=Ye(Ve),Ue={};Object.defineProperty(Ue,"__esModule",{value:!0});Ue.default=class{constructor(t,e,n){this.position={x:100*t,y:100*e,z:100*n}}dispose(){}isTracking(){}isStopped(){}transform(){translate(this.position.x,this.position.y,this.position.z)}};var je=Ye(Ue);function Ye(t){return t&&t.__esModule?t:{default:t}}class He extends Be.default{constructor(){super(),this.canvas=null}initAR(){this.__createButton(),navigator?.xr&&this.__sessionCheck()}__startSketch(t){this.xrSession=this.xrButton.session=t,this.xrSession.addEventListener("end",this.__onSessionEnded),"function"==typeof touchStarted&&this.xrSession.addEventListener("select",touchStarted),this.canvas=p5.instance.canvas,p5.instance._renderer._curCamera.cameraType="custom",this.__onRequestSession(),p5.instance._decrementPreload()}__onSelect(t){const e=window.mousePressed;"function"==typeof e&&e(t)}__detectHit(t){if(null==t)return console.warn("You must pass the touchStarted event to detectHit."),null;if(!this.xrSession)return null;if(this.xrHitTestSource&&this.viewer.pose&&this.frame){const t=this.frame.getHitTestResults(this.xrHitTestSource);if(t.length>0){const e=t[0].getPose(this.xrRefSpace);return createVector(e.transform.position.x,e.transform.position.y,e.transform.position.z)}}}__createAnchor(t){return null==t?null:new je.default(t.x,t.y,t.z)}__onXRButtonClicked(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.xr.requestSession("immersive-ar",{requiredFeatures:["local","hit-test"]}).then((t=>{this.__startSketch(t)}),(t=>{console.log(`${t} unable to request an immersive-ar session.`)}))}__onRequestSession(){this.gl=this.canvas.getContext("webgl",{xrCompatible:!0}),this.gl.makeXRCompatible().then((()=>{this.xrSession.updateRenderState({baseLayer:new XRWebGLLayer(this.xrSession,this.gl)})})),this.xrSession.requestReferenceSpace("viewer").then((t=>{this.xrViewerSpace=t,this.xrSession.requestHitTestSource({space:this.xrViewerSpace}).then((t=>{this.xrHitTestSource=t}))})),this.xrSession.requestReferenceSpace("local").then((t=>{this.xrRefSpace=t,this.xrSession.requestAnimationFrame(this.__onXRFrame.bind(this))}))}}Oe.default=He;var Ge=Ze(Oe);function Ze(t){return t&&t.__esModule?t:{default:t}}window.p5xr={instance:null},p5.prototype.createVRCanvas=function(t){noLoop(),p5xr.instance=new $e.default(t),p5xr.instance.__initVR()},p5.prototype.createARCanvas=function(){noLoop(),p5xr.instance=new Ge.default,p5xr.instance.initAR()},p5.prototype.getXRButton=function(){if(p5xr&&p5xr.instance&&p5xr.instance.xrButton)return p5xr.instance.xrButton;console.warn("No XR button found. Make sure to call createVRCanvas() or createARCanvas() first.")},p5.prototype.createXRButton=function(t){return new p5xrButton(t)},p5.prototype.setVRBackgroundColor=function(t,e,n){p5xr.instance.curClearColor=color(t,e,n)},p5.prototype.surroundTexture=function(t){push(),texture(t),rotateX(PI),scale(-1,1,1),sphere(300,60,40),pop()},p5.prototype.createAnchor=function(t){if(!p5xr.instance.isVR)return p5xr.instance.__createAnchor(t)},p5.prototype.detectHit=function(t){if(!p5xr.instance.isVR)return p5xr.instance.__detectHit(t)},p5.prototype.getXRInput=function(t){if(0!==p5xr.instance.xrSession.inputSources.length)return p5xr.instance.__getXRInput(t)},p5.prototype.setViewerPosition=function(t,e,n){const{viewer:i}=p5xr.instance;i.setPosition(t,e,n)},p5.prototype.getViewer=function(){return p5xr.instance&&p5xr.instance.viewer||console.warn("No viewer found. Make sure to call createVRCanvas() or createARCanvas() first."),p5xr.instance.viewer},p5.prototype.sticky=function(t=!1){push(),p5xr.instance.viewer.drawOnTop=t,t&&p5.instance._renderer.GL.disable(p5.instance._renderer.GL.DEPTH_TEST),p5.instance._renderer.uMVMatrix.set(p5.Matrix.identity());const e=p5xr.instance.viewer.position;setViewerPosition(e.x,e.y,e.z)},p5.prototype.noSticky=function(){p5.instance._renderer.GL.enable(p5.instance._renderer.GL.DEPTH_TEST),pop()},p5.prototype.getRayFromScreen=function(t,e){p5xr.instance&&p5xr.instance.viewer||console.warn("No viewer found to calculate Ray. Make sure to call createVRCanvas() or createARCanvas() first.");const{viewer:n}=p5xr.instance;return n.getRayFromScreen(t,e)},p5.prototype.intersectsSphere=function(t){let e={origin:null,direction:null};if(2===arguments.length&&Object.hasOwn(arguments[1],"origin"))e.origin=arguments[1].origin.copy(),e.direction=arguments[1].direction.copy();else{const t=arguments[1]||0,n=arguments[2]||0;e=p5xr.instance.viewer.getRayFromScreen(t,n)}if(null===e)return!1;let n=p5.instance._renderer.uMVMatrix.copy();n.transpose(n),n=n.mat4;const i=new p5.Vector(0,0,0);if(i.x=n[3],i.y=n[7],i.z=n[11],p5.Vector.sub(e.origin,i).mag()<=t)return!0;if(p5.Vector.dot(p5.Vector.sub(i,e.origin),e.direction)<0)return!1;const r=p5.Vector.sub(e.origin,i),s=2*p5.Vector.dot(e.direction,r),o=p5.Vector.mag(r)*p5.Vector.mag(r)-t*t,a=s*s-4*o;return a>=0},p5.prototype.intersectsBox=function(){const t=arguments[0];let e,n,i={origin:null,direction:null};Object.hasOwn(arguments[arguments.length-1],"origin")?(i.origin=arguments[arguments.length-1].origin.copy(),i.direction=arguments[arguments.length-1].direction.copy(),e=arguments.length>2?arguments[1]:t,n=arguments.length>3?arguments[2]:e):5===arguments.length?(i=p5xr.instance.viewer.getRayFromScreen(arguments[3],arguments[4]),e=arguments[1],n=arguments[2]):(i=p5xr.instance.viewer.getRayFromScreen(0,0),e=arguments.length>1?arguments[1]:t,n=arguments.length>2?arguments[2]:e);let r=p5.instance._renderer.uMVMatrix.copy();r.transpose(r),r.invert(r),r=r.mat4;const s=i.origin.copy();i.origin.x=r[0]*s.x+r[1]*s.y+r[2]*s.z+r[3],i.origin.y=r[4]*s.x+r[5]*s.y+r[6]*s.z+r[7],i.origin.z=r[8]*s.x+r[9]*s.y+r[10]*s.z+r[11];const o=i.direction.copy();i.direction.x=r[0]*o.x+r[1]*o.y+r[2]*o.z,i.direction.y=r[4]*o.x+r[5]*o.y+r[6]*o.z,i.direction.z=r[8]*o.x+r[9]*o.y+r[10]*o.z,i.direction.normalize();const a=new p5.Vector(-.5*t,-.5*e,-.5*n),h=new p5.Vector(.5*t,.5*e,.5*n),c=(a.x-i.origin.x)/i.direction.x,u=(h.x-i.origin.x)/i.direction.x,l=(a.y-i.origin.y)/i.direction.y,p=(h.y-i.origin.y)/i.direction.y,d=(a.z-i.origin.z)/i.direction.z,f=(h.z-i.origin.z)/i.direction.z,v=Math.max(Math.max(Math.min(c,u),Math.min(l,p)),Math.min(d,f)),m=Math.min(Math.min(Math.max(c,u),Math.max(l,p)),Math.max(d,f));return!(m<0||v>m)},p5.prototype.intersectsPlane=function(){let t={origin:null,direction:null};const{origin:e,direction:n}=arguments.length>0?arguments[0]:{};e&&n?(t.origin=e.copy(),t.direction=n.copy()):t=p5xr.instance.viewer.getRayFromScreen(arguments[0],arguments[1]);let i=p5.instance._renderer.uMVMatrix.copy();i.transpose(i),i.invert(i),i=i.mat4;const r=t.origin.copy();t.origin.x=i[0]*r.x+i[1]*r.y+i[2]*r.z+i[3],t.origin.y=i[4]*r.x+i[5]*r.y+i[6]*r.z+i[7],t.origin.z=i[8]*r.x+i[9]*r.y+i[10]*r.z+i[11];const s=t.direction.copy();t.direction.x=i[0]*s.x+i[1]*s.y+i[2]*s.z,t.direction.y=i[4]*s.x+i[5]*s.y+i[6]*s.z,t.direction.z=i[8]*s.x+i[9]*s.y+i[10]*s.z,t.direction.normalize();const o=new p5.Vector(0,0,1),a=new p5.Vector(0,0,0),h=p5.Vector.sub(a,t.origin),c=Math.abs(p5.Vector.dot(t.direction,o));if(0===c)return null;const u=Math.abs(p5.Vector.dot(h,o)/c),l=p5.Vector.add(t.origin,t.direction.copy().setMag(u));return createVector(l.x,l.y)},p5.prototype.generateRay=function(t,e,n,i,r,s){const o=new p5.Vector(t,e,n);let a=new p5.Vector(i,r,s);a=p5.Vector.sub(a,o),a.normalize();let h=p5.instance._renderer.uMVMatrix.copy();h.transpose(h),h=h.mat4;const c=o.copy();o.x=h[0]*c.x+h[1]*c.y+h[2]*c.z+h[3],o.y=h[4]*c.x+h[5]*c.y+h[6]*c.z+h[7],o.z=h[8]*c.x+h[9]*c.y+h[10]*c.z+h[11];const u=a.copy();return a.x=h[0]*u.x+h[1]*u.y+h[2]*u.z,a.y=h[4]*u.x+h[5]*u.y+h[6]*u.z,a.z=h[8]*u.x+h[9]*u.y+h[10]*u.z,a.normalize(),{origin:o,direction:a}}})();